#!/bin/bash
# ==============================================================================
# Configuration tmux avec bandeau d'informations
# Barre de statut adaptée au système de profils multi-machines
# ==============================================================================

# Position de la barre de statut
set -g status-position bottom

# Style général de la barre
set -g status-style bg=colour235,fg=colour136,bold

# Longueur des sections
set -g status-left-length 60
set -g status-right-length 150

# Section gauche : Indicateur tmux + hostname + user
set -g status-left "#[fg=green,bold]#{?client_prefix,🟢 TMUX,⚪ tmux} #[fg=cyan,bold]#H #[fg=yellow]#(whoami) "

# Section droite : Profil + Batterie + RAM + CPU + Heure
set -g status-right "#[fg=magenta,bold]💻 #(cat ~/.config/ubuntu-configs/machine_profile 2>/dev/null || echo 'default') #[fg=yellow]| 🔋 #(~/ubuntu-configs/scripts/tmux_battery.sh) #[fg=cyan]| 💾 #(free -h | awk '/^Mem:/ {print $3\"/\"$2}') #[fg=green]| ⚙️  #(uptime | awk -F'load average:' '{print $2}' | awk '{print $1}' | tr -d ',') #[fg=red,bold]| ⏰ %d/%m %H:%M:%S"

# Fenêtre active
set -g window-status-current-style fg=colour166,bg=colour238,bold
set -g window-status-current-format " #I:#W "

# Fenêtre inactive
set -g window-status-style fg=colour244,bg=colour235
set -g window-status-format " #I:#W "

# Intervalle de rafraîchissement (secondes)
set -g status-interval 2

# Message
set -g message-style fg=colour166,bg=colour235,bold

# Numérotation des fenêtres à partir de 1
set -g base-index 1
setw -g pane-base-index 1

# Renommage automatique des fenêtres
setw -g automatic-rename on
set -g renumber-windows on

# Historique
set -g history-limit 10000

# Souris
set -g mouse on

# Mode vi
setw -g mode-keys vi

# Raccourcis clavier personnalisés
bind r source-file ~/.tmux.conf \; display "⚙️  Configuration rechargée!"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Afficher un message de bienvenue
set -g display-time 2000
set -g status-justify left
